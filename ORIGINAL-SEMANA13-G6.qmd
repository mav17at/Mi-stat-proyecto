---
title: "semana13-g6.."
format: html
editor: visual
GRUPO: "6"
integrantes: "Alarcon Tacson, Maria Victoria"
"Calderon Luque, Naomy Alexandra"
"De la Rosa Olachea, Randa Rosario"
"Muñante Quispe, Enith Margoryt"
---

Instalar paquetes

```{r}
install.packages("factoextra")
install.packages("cluster")
```

```{r}
library(factoextra)
library(cluster)
library(here)
library(rio)
library(tidyverse)
```

###2.2.1 IMPORTANDO LOS DATOS

```{r}
 conoc_actit_factor_cancer_cervical <- import(here("data", "conoc_actit_factor_cancer_cervical.csv"))
```
## 2.3 Preparación de los datos

### 2.3.1 Solo datos numéricos
```{r}
conoc_actit_factor_cancer_cervical_1 = conoc_actit_factor_cancer_cervical |> 
  select(-e_marital, -antec_ets) |> 
  column_to_rownames("paciente_num")
```


2.3.2 Estandarizar
```{r}
conoc_actit_factor_cancer_cervical_escalado <- scale(
  dplyr::select_if(conoc_actit_factor_cancer_cervical_1, is.numeric)
)
```
un vistazo
```{r}
head(conoc_actit_factor_cancer_cervical_1)
```

Conclusión: Podemos concluir que el dataset muestra que muchas mujeres tienen educación superior y buen conocimiento sobre el cáncer de cuello uterino, aún predominan actitudes negativas y prácticas incorrectas. Esto indica una brecha entre el conocimiento y la prevención efectiva, destacando la necesidad de mejorar la educación en salud.
```{r}
head(conoc_actit_factor_cancer_cervical_escalado)
```
Conclusión: Se puede concluir que este grafico contiene variables numericas escaladas, en los cuales son: edad, edad_relacion_sexual , parejas_sex , num_hijos. Por lo cual se puede mencionar que algunos valores son negativos y positivos, lo que sugiere una escalación tipo z-score (media 0, desviación estándar 1). También se observa que la persona 3 tiene un valor muy bajo en edad (-1.71) y un valor alto en parejas_sex (0.87), lo que nos indica que para su edad es bastante menor que la media y ha tenido un número de parejas sexuales mayor que el promedio. Por último lo que también es resaltante es que las columnas están listas para usarse en modelos estadísticos o de aprendizaje automático que requieren entrada numérica estandarizada.

```{r}
dist_conoc_actit_factor_cancer_cervical <- dist(conoc_actit_factor_cancer_cervical_escalado, method = "euclidean")
```

## 2.4.1 (opcional) Visualizando las distancias euclidianas con un mapa de calor
```{r}
fviz_dist(dist_conoc_actit_factor_cancer_cervical)
```
Conclusión: Se puede concluir que existen grupos de observaciones que presentan similitudes internas claras (zonas rojizas agrupadas) y otros grupos de observaciones que se distinguen bastante de las demás (zonas azuladas). Lo cual esto nos sugiere que podrían existir patrones o clústeres naturales dentro de los datos.

```{r}
dist_link_conoc_actit_factor_cancer_cervical <- hclust(d = dist_conoc_actit_factor_cancer_cervical, method = "ward.D2")
```

2.7 Dendrogramas para la visualización de patrones

```{r}
fviz_dend(dist_link_conoc_actit_factor_cancer_cervical, cex = 0.7)
```

Interpretación del gráfico:

Eje vertical (Height): Representa la distancia o disimilitud entre los grupos fusionados, por lo cual a mayor altura, mayor diferencia entre los grupos que se unen.

Ramas: Cada rama representa una observación individual o un grupo de observaciones similares.

Uniones: Las uniones en el gráfico muestran en qué punto según la distancia, se agrupan dos elementos o grupos.

Conclusión: Se puede concluir que se observan varios grupos bien definidos, el dendrograma sugiere que los datos pueden dividirse claramente en 3 a 5 clústeres principales, dependiendo del corte que se realice, también que las uniones a mayor altura indican que hay subgrupos muy diferentes entre sí, lo cual confirma que en el conjunto de datos existen patrones o perfiles distintos. Por último esta segmentación puede ser útil para identificar perfiles de conocimiento, actitud o factores relacionados al cáncer cervical en la población analizada.

```{r}
fviz_dend(dist_link_conoc_actit_factor_cancer_cervical, 
          k = 3,
          cex = 0.5,
          k_colors = c("#2E9FDF", "#E7B800", "#FC4E07"),
          color_labels_by_k = TRUE, 
          rect = TRUE)
```


Conclusión: Se puede concluir que se identifican 3 grupos principales (clusters) bien diferenciados en los datos, los cuales están coloreados en azul, amarillo y rojo, lo cual esto podría indicar que las observaciones pueden dividirse de manera significativa en tres patrones o perfiles distintos basados en los factores analizados, que la altura de las ramas donde se realiza el corte (alrededor de 20) sugiere que hay diferencias marcadas entre estos grupos, las cajas punteadas muestran los límites de cada grupo, y cada uno contiene un conjunto de individuos más similares entre sí que con los de otros grupos. Por lo tanto como profesionales de salud este grafico nos ayudara a identificar perfiles de riesgo distintos, de diseñar estrategias de intervención específicas para cada grupo en el cual se vea afectado y orgarnicar un seguimiento médico personalizado o campañas de prevención según las características del grupo.

3. Agrupamiento con el algoritmo K-Means

3.1 Estimando el número óptimo de clusters

Primero escalamos los datos:

```{r}
library(dplyr)
conoc_actit_factor_cancer_cervical_escalado <- conoc_actit_factor_cancer_cervical_1 |>
  select_if(is.numeric) |>
  scale()
```



Ahora graficamos la suma de cuadrados dentro de los gráficos

```{r}
fviz_nbclust(conoc_actit_factor_cancer_cervical_escalado, kmeans, nstart = 25, method = "wss") + 
  geom_vline(xintercept = 3, linetype = 2)
```


Conclusión: Se puede concluir que el gráfico muestra la relación entre el número de clústeres (k) y la suma total de cuadrados dentro de los grupos (Total Within Sum of Squares), a medida que aumenta k, la variabilidad dentro de los grupos disminuye, pero con rendimientos decrecientes, por lo tanto el codo del gráfico, en k = 3, señala el punto donde agregar más clústeres ya no mejora significativamente la compactación de los grupos, lo que indica que 3 es el número óptimo de clústeres. Por lo tanto este análisis es fundamental para segmentar correctamente a las participantes del estudio según patrones de conocimiento, actitudes o factores comunes, y mejorar la interpretación de los datos.

3.3 Cálculo del agrupamiento k-means
```{r}
set.seed(123)
km_res <- kmeans(conoc_actit_factor_cancer_cervical_escalado, 3, nstart = 25)
```

```{r}
km_res
```


Conclusión: Se puede concluir que el análisis agrupó los datos en tres clusters de tamaños considerablemente diferentes (163, 49, y 6), por lo tanto la primera imagen presenta las medias de las variables para cada cluster, sugiriendo diferencias significativas entre los grupos en cuanto a edad, relación sexual, número de parejas sexuales y número de hijos, también se muestra la asignación de cada punto de datos a uno de los tres clusters, por lo tanto la información adicional sobre la suma de cuadrados dentro de los clusters indica la calidad del agrupamiento, sugiriendo una varianza relativamente alta dentro de los clusters un 40.7% de la varianza total explicada.

3.4 Visualización de los clústeres k-means
```{r}
fviz_cluster(
  km_res,
  data = conoc_actit_factor_cancer_cervical_escalado,
  palette = c("#2E9FDF", "#E7B800", "#FC4E07"),
  ellipse.type = "euclid",
  repel = TRUE,
  ggtheme = theme_minimal()
)
```


Conclusión: Se puede concluiro que el análisis de componentes principales (PCA) redujo los datos a dos dimensiones que explican el 62.5% de la variabilidad y también se identificaron tres grupos: Cluster 1 (azul) es el más numeroso y homogéneo, Cluster 2 (amarillo) es intermedio y moderadamente disperso, Cluster 3 (rojo) es pequeño y claramente diferenciado, posiblemente con respuestas atípicas. Por lo tanto la segmentación revela patrones claros entre individuos, útiles para diseñar intervenciones específicas, especialmente para el grupo 3 y los elipses euclidianas indican la distribución y dispersión de cada grupo.

